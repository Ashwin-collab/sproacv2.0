<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SPROAC</title>

<style>
body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f3f4f6;
}

/* HEADER */
.header{
    background:#6aa52f;
    color:white;
    text-align:center;
    padding:18px;
    font-size:22px;
    font-weight:bold;
    letter-spacing:1px;
}

/* CARD */
.card{
    background:white;
    margin:15px;
    border-radius:14px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
    padding:15px;
}

/* BUTTON */
.btn{
    display:block;
    width:90%;
    margin:10px auto;
    padding:12px;
    border:none;
    border-radius:10px;
    background:#6aa52f;
    color:white;
    font-size:16px;
    cursor:pointer;
}
.btn:hover{ background:#5b9128; }

/* SENSOR CARDS */
.sensor-grid{
    display:flex;
    justify-content:space-around;
    flex-wrap:wrap;
}

.sensor{
    width:30%;
    background:#f9fafb;
    border-radius:10px;
    padding:10px;
    text-align:center;
    margin:5px;
}

.value{
    font-size:20px;
    font-weight:bold;
    color:#6aa52f;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
}
th,td{
    border-bottom:1px solid #ddd;
    padding:8px;
    font-size:13px;
}
th{ background:#6aa52f; color:white; }

.state{ display:none; }

/* TOP DATETIME */
.datetime{
    position:absolute;
    right:10px;
    top:8px;
    font-size:12px;
    text-align:right;
    color:white;
}
</style>
</head>

<body>

<div class="header">
ğŸŒ± SPROAC
<div class="datetime">
<div id="day"></div>
<div id="date"></div>
<div id="time"></div>
</div>
</div>

<!-- MAIN MENU -->
<div id="MAIN" class="state">
<div class="card">
<h3>Main Menu</h3>
<button class="btn" onclick="setState('CATEGORY')">ğŸ¥• Vegetables / Fruits</button>
<button class="btn" onclick="setState('LIVE')">ğŸ“¡ Live Sensors</button>
<button class="btn" onclick="setState('LOG')">ğŸ“‹ All Readings</button>
<button class="btn" onclick="setState('ABOUT')">â„¹ About</button>
</div>
</div>

<!-- CATEGORY -->
<div id="CATEGORY" class="state">
<div class="card">
<h3>Select Produce</h3>
<button class="btn" onclick="selectItem('Onion')">ğŸ§… Onion</button>
<button class="btn" onclick="selectItem('Garlic')">ğŸ§„ Garlic</button>
<button class="btn" onclick="selectItem('Potato')">ğŸ¥” Potato</button>
<button class="btn" onclick="selectItem('Tomato')">ğŸ… Tomato</button>
<button class="btn" onclick="selectItem('Banana')">ğŸŒ Banana</button>
<button class="btn" onclick="setState('MAIN')">â¬… Back</button>
</div>
</div>

<!-- LIVE SENSOR -->
<div id="LIVE" class="state">
<div class="card">
<h3>Live Sensor Data</h3>

<div class="sensor-grid">
<div class="sensor">ğŸŒ¡ Temp<div id="temp" class="value">--</div></div>
<div class="sensor">ğŸ’§ Humidity<div id="hum" class="value">--</div></div>
<div class="sensor">â˜ Gas<div id="gas" class="value">--</div></div>
</div>

<button class="btn" onclick="setState('MAIN')">â¬… Back</button>
</div>
</div>

<!-- LOG -->
<div id="LOG" class="state">
<div class="card">
<h3>Sensor Log</h3>
<table id="table">
<thead>
<tr><th>Date</th><th>Temp</th><th>Hum</th><th>H2S</th><th>MQ135</th><th>Alcohol</th></tr>
</thead>
<tbody></tbody>
</table>
<button class="btn" onclick="setState('MAIN')">â¬… Back</button>
</div>
</div>

<!-- ABOUT -->
<div id="ABOUT" class="state">
<div class="card">
<h3>About SPROAC</h3>
<p>
Smart Produce Rotting & Oxidation Alert Controller â€” IoT system for early spoilage detection
using temperature, humidity, and gas sensors.
</p>
<button class="btn" onclick="setState('MAIN')">â¬… Back</button>
</div>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbyNjAvZGUc4VsbMXySa04ItqkSReNQMlsgtAwqRng_Y60VlRXiwIU0pjpQ3LvUxRhGCsg/exec";

let currentItem="Onion";

/* STATE */
function setState(s){
document.querySelectorAll(".state").forEach(x=>x.style.display="none");
document.getElementById(s).style.display="block";
}
setState("MAIN");

/* SELECT ITEM */
function selectItem(item){
currentItem=item;
setState("LIVE");
}

/* FETCH DATA */
async function updateData(){
try{
const r=await fetch(API_URL);
const d=await r.json();
if(!d.length) return;
const last=d[d.length-1];

document.getElementById("temp").textContent=last.temperature+" Â°C";
document.getElementById("hum").textContent=last.humidity+" %";

let gas=(currentItem==="Potato")?last.mq135:
(currentItem==="Tomato"||currentItem==="Banana")?last.alcohol:last.h2s;

document.getElementById("gas").textContent=gas+" ppm";

/* TABLE */
const tb=document.querySelector("#table tbody");
tb.innerHTML="";
d.slice().reverse().forEach(r=>{
tb.innerHTML+=`<tr><td>${r.datetime}</td><td>${r.temperature}</td><td>${r.humidity}</td><td>${r.h2s}</td><td>${r.mq135}</td><td>${r.alcohol}</td></tr>`;
});

}catch(e){}
}
setInterval(updateData,3000);

/* DATE TIME */
function updateTime(){
const n=new Date();
const days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
const months=["January","February","March","April","May","June","July","August","September","October","November","December"];

document.getElementById("day").textContent=days[n.getDay()];
document.getElementById("date").textContent=n.getDate()+" "+months[n.getMonth()]+" "+n.getFullYear();

let h=n.getHours(),ampm=h>=12?"PM":"AM";
h=h%12||12;
document.getElementById("time").textContent=
h+":"+String(n.getMinutes()).padStart(2,'0')+" "+ampm;
}
setInterval(updateTime,1000);
updateTime();
</script>

</body>
</html>
